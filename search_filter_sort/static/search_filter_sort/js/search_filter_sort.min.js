var can_do_enter_button_form_submissions=!0,search_bys=[],filter_bys={},original_filter_bys={},range_filters={},sort_bys=[],paginate_by=[],page_number=1;function initialize_search_filter_sort(){paginate_by=[default_pagination];var e=$("#page_number_text"),t=$("#select_all_pages_checkbox"),s=$(".object-list-checkbox"),n=$(".sfs-action-btn"),i=$("#select_all_objects_checkbox");$("#paginate_by_select").change(function(){paginate_by=[$(this).val()],goto_new_url(!0,!0,!0)}),e.val()&&page_num_input_form_size(e),page_num_input_form_size(e),e.on("input",function(){page_num_input_form_size(e)}),$(window).keydown(function(t){13===t.key&&$("#search_text").is(":focus")&&search(),13===t.key&&e.is(":focus")&&goto_page(e.val())}),t.change(function(){var e=$(this).prop("checked");$("#select_all_objects_checkbox").attr("disabled",e),s.each(function(){$(this).prop("checked",!1),$(this).attr("disabled",e)})}),set_filter_mousedown_functions(),set_filter_keydown_functions(),get_url_parameters(search_bys,"search_by"),get_filter_by_parameters(),get_url_parameters(sort_bys,"sort_by"),get_url_parameters(paginate_by,"paginate_by"),set_filters(),set_sort_symbols(),set_pagination(),fix_range_filters(),search_bys.length>0&&$("#clear_search_button").prop("disabled",!1),set_filter_button_states(),sort_bys.length>0&&$("#clear_sorts_button").prop("disabled",!1),i.change(function(){s.length>0&&n.attr("disabled",!this.checked)}),t.change(function(){s.length>0&&n.attr("disabled",!this.checked)}),s.change(function(){i.is(":not(:checked)")&&(!$("table").find($(".object-list-checkbox:checked")).length>0?n.attr("disabled","disabled"):n.removeAttr("disabled"))})}function page_num_input_form_size(e){if(e.val()){var t=10*e.val().length+25+"px";e.css({width:t,"max-width":"125px"})}}function set_filter_mousedown_functions(){var e,t,s,n=null;$("select.multi-select.sfs-filter").mousedown(function(e){e.preventDefault(),n=this,$(n).focus()}).mousemove(function(e){e.preventDefault()}),$("select.multi-select.sfs-filter option").click(function(){var i=n.scrollTop;return t=$(this).parent().attr("name").split("_filter")[0],s=$("#"+t+"_quantity_span"),$(this).prop("selected")?($(this).prop("selected",!1),(e=filter_bys[t].split(",")).splice(e.indexOf($(this).val()),1),filter_bys[t]=e.join(","),0===filter_bys[t].length?(s.text(""),delete filter_bys[t]):s.text("("+filter_bys[t].split(",").length+")")):($(this).prop("selected",!0),filter_bys[t]?filter_bys[t]+=","+$(this).val():filter_bys[t]=$(this).val(),s.text("("+filter_bys[t].split(",").length+")")),setTimeout(function(){n.scrollTop=i},0),set_filter_button_states(),!1})}function set_filter_keydown_functions(){var e,t;$("input.range-filter").on("input",function(){e=$(this).val().length,t=$(this).attr("name").split("-filter")[0],e>0?range_filters[t]=$(this).val():range_filters[t]&&0===e&&delete range_filters[t],set_filter_button_states()})}function get_url_parameters(e,t){var s,n,i=decodeURIComponent(window.location.href).split("?");if(2===i.length)for(i=i[1].split("&"),s=0;s<i.length;s++)(n=i[s].split("="))[0]===t&&e.push(n[1])}function get_filter_by_parameters(){var e,t,s=decodeURIComponent(window.location.href).split("?"),n=[],i=[];if(2===s.length){for(s=s[1].split("&"),e=0;e<s.length;e++)"filter_name"===(t=s[e].split("="))[0]&&n.push(t[1]);for(e=0;e<s.length;e++)"filter_value"===(t=s[e].split("="))[0]&&i.push(t[1]);for(e=0;e<n.length;e++)filter_bys[n[e]]=i[e];original_filter_bys=$.extend(!0,{},filter_bys)}}function set_filters(){var e,t,s,n=$.extend({},filter_bys);if("undefined"!=typeof filter_names)for(e=0;e<filter_names.length;e++)t=filter_names[e],s=$("#"+t+"_quantity_span"),filter_bys[t]&&($("#"+t+"_filter").val(filter_bys[t].split(",")),s.text("("+filter_bys[t].split(",").length+")"),delete n[t]);Object.keys(n).length>0&&$("#hidden_filters_message_div").css("display","")}function set_sort_symbols(){var e,t,s;for(e=0;e<sort_bys.length;e++)2===(t=sort_bys[e].split("-")).length?(change_sorting_symbol(t[1],"sorting-desc"),s=$("#"+t[1]+"_number")):(change_sorting_symbol(sort_bys[e],"sorting-asc"),s=$("#"+sort_bys[e]+"_number")),s.text(e+1),s.show()}function set_pagination(){$("#paginate_by_select").val(paginate_by[paginate_by.length-1])}function fix_range_filters(){var e;$("input.range-filter").each(function(){e=$(this).attr("name").split("-filter")[0],void 0!==filter_bys[e]&&(range_filters[e]=filter_bys[e],delete filter_bys[e])})}function add_sort_by(e){var t=sort_bys.indexOf(e),s=$("#"+e+"_number");s.hide(),-1===t&&(t=sort_bys.indexOf("-"+e)),-1===t?(sort_bys.push(e),change_sorting_symbol(e,"sorting-asc")):t===sort_bys.length-1?2===sort_bys[t].split("-").length?(sort_bys.splice(t,1),change_sorting_symbol(e,"sorting-none"),s.hide()):(sort_bys[t]="-"+e,change_sorting_symbol(e,"sorting-desc")):(sort_bys.splice(t,1),change_sorting_symbol(e,"sorting-none")),goto_new_url(!0,!0,!0)}function goto_new_url(e,t,s){var n,i,l="?";if(add_spinner(),paginate_by[paginate_by.length-1]!==default_pagination&&(l+="paginate_by="+paginate_by[paginate_by.length-1]+"&"),1!==page_number&&(l+="page="+page_number+"&"),e)for(n=0;n<search_bys.length;n++)l+="search_by="+search_bys[n]+"&";if(t){for(i in filter_bys)l+="filter_name="+i+"&filter_value="+filter_bys[i]+"&";for(i in range_filters)l+="filter_name="+i+"&filter_value="+range_filters[i]+"&"}if(s)for(n=0;n<sort_bys.length;n++)l+="sort_by="+sort_bys[n]+"&";"?"===l?l="":"&"===l.charAt(l.length-1)&&(l=l.slice(0,-1)),window.location.href=window.location.href.split("?")[0]+l}function change_sorting_symbol(e,t){var s=$("#"+e+"_header").find(".sort-controls");s.removeClass("sorting-none"),s.removeClass("sorting-asc"),s.removeClass("sorting-desc"),s.addClass(t)}function set_filter_button_states(){var e=$("#clear_filters_button"),t=$("#apply_filters_button");0===Object.keys(original_filter_bys).length&&0===Object.keys(filter_bys).length&&0===Object.keys(range_filters).length?(e.prop("disabled",!0),t.prop("disabled",!0)):(e.prop("disabled",!1),t.prop("disabled",!1),$("#collapse_one").collapse("show"))}function goto_page(e){isNaN(e)||Math.floor(+e)===+e&&$.isNumeric(+e)&&(page_number=e,goto_new_url(!0,!0,!0))}function clear_search(){goto_new_url(!1,!0,!0)}function clear_filters(){goto_new_url(!0,!1,!0)}function clear_sorts(){goto_new_url(!0,!0,!1)}function clear_all(){window.location.href=window.location.href.split("?")[0]}function search(){var e=$("#search_text");search_bys=""!==e.val()?[e.val()]:[],goto_new_url(!0,!0,!0)}function apply_filters(){goto_new_url(!0,!0,!0)}function toggle_select_all_objects(){var e=$(".object-list-checkbox");$("#select_all_objects_checkbox").is(":checked")?e.each(function(){$(this).prop("checked",!0)}):e.each(function(){$(this).prop("checked",!1)})}function get_new_url_via_checkboxes(e){var t,s=$(".object-list-checkbox"),n=e+"?",i=!1;return $("#select_all_pages_checkbox").is(":checked")?(2===(t=decodeURIComponent(window.location.href).split("?")).length&&(n+=t[1]),n):(s.each(function(){i||$(this).is(":checked")&&(i=!0)}),i?(n+="filter_name=id&filter_value=",s.each(function(){!0===$(this).is(":checked")&&(n+=$(this).val()+",")}),","===n.charAt(n.length-1)&&(n=n.slice(0,-1)),n):(2===(t=decodeURIComponent(window.location.href).split("?")).length&&(n+=t[1]+"&"),n+="__RETURN_EMPTY__=1"))}function goto_new_url_via_checkboxes(e){window.location.href=get_new_url_via_checkboxes(e)}